<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity"
   prefHeight="650.0" prefWidth="800.0" stylesheets="@../css/styles.css"
   xmlns="http://javafx.com/javafx/8.0.171" xmlns:fx="http://javafx.com/fxml/1"
   fx:controller="com.group4.controllers.EditProfileController">
   <center>
      <ScrollPane fitToWidth="true" vbarPolicy="AS_NEEDED" hbarPolicy="NEVER"
         style="-fx-background: #f5f7fa;">
         <VBox alignment="TOP_CENTER" spacing="30" style="-fx-padding: 30;">
            <!-- Profile Picture Section -->
            <VBox alignment="CENTER" spacing="15">
               <StackPane styleClass="profile-image-container">
                  <ImageView fx:id="profileImageView" fitHeight="200" fitWidth="200" 
                     styleClass="profile-image" preserveRatio="true" smooth="true" 
                     pickOnBounds="true" onMouseClicked="#changeProfilePicture">
                     <image>
                        <Image url="@../images/default-avatar.png" backgroundLoading="true" />
                     </image>
                     <StackPane.margin>
                        <Insets top="0" right="0" bottom="0" left="0"/>
                     </StackPane.margin>
                  </ImageView>
               </StackPane>
            </VBox>

            <!-- User Details Form -->
            <VBox alignment="CENTER" spacing="25" styleClass="form-container">
               <GridPane hgap="20" vgap="20">
                  <columnConstraints>
                     <ColumnConstraints hgrow="NEVER" minWidth="150" prefWidth="200" />
                     <ColumnConstraints hgrow="ALWAYS" minWidth="250" prefWidth="350" />
                  </columnConstraints>
                  <rowConstraints>
                     <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                     <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                     <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                     <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                  </rowConstraints>

                  <!-- Basic Information Section -->
                  <Label text="First Name" styleClass="form-label" GridPane.rowIndex="0"
                     GridPane.columnIndex="0" />
                  <TextField fx:id="firstNameField" styleClass="form-field" GridPane.rowIndex="0"
                     GridPane.columnIndex="1" />

                  <Label text="Last Name" styleClass="form-label" GridPane.rowIndex="1"
                     GridPane.columnIndex="0" />
                  <TextField fx:id="lastNameField" styleClass="form-field" GridPane.rowIndex="1"
                     GridPane.columnIndex="1" />

                  <Label text="Email Address" styleClass="form-label" GridPane.rowIndex="2"
                     GridPane.columnIndex="0" />
                  <TextField fx:id="emailField" styleClass="form-field" GridPane.rowIndex="2"
                     GridPane.columnIndex="1" />

                  <Label text="Contact Number" styleClass="form-label" GridPane.rowIndex="3"
                     GridPane.columnIndex="0" />
                  <TextField fx:id="contactNumberField" styleClass="form-field"
                     GridPane.rowIndex="3" GridPane.columnIndex="1" />

                  <!-- Password Update Section (Collapsible) -->
                  <TitledPane text="Change Password" collapsible="true" animated="true"
                     expanded="false" styleClass="password-section" GridPane.columnSpan="2"
                     GridPane.rowIndex="4">
                     <GridPane hgap="20" vgap="15">
                        <columnConstraints>
                           <ColumnConstraints hgrow="NEVER" minWidth="150" prefWidth="200" />
                           <ColumnConstraints hgrow="ALWAYS" minWidth="250" prefWidth="350" />
                        </columnConstraints>
                        <rowConstraints>
                           <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                           <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                           <RowConstraints minHeight="40" prefHeight="40" vgrow="SOMETIMES" />
                        </rowConstraints>

                        <Label text="Current Password" styleClass="form-label" GridPane.rowIndex="0"
                           GridPane.columnIndex="0" />
                        <PasswordField fx:id="currentPasswordField" styleClass="form-field"
                           GridPane.rowIndex="0" GridPane.columnIndex="1" />

                        <Label text="New Password" styleClass="form-label" GridPane.rowIndex="1"
                           GridPane.columnIndex="0" />
                        <PasswordField fx:id="passwordField" styleClass="form-field"
                           GridPane.rowIndex="1" GridPane.columnIndex="1" />

                        <Label text="Confirm Password" styleClass="form-label" GridPane.rowIndex="2"
                           GridPane.columnIndex="0" />
                        <PasswordField fx:id="confirmPasswordField" styleClass="form-field"
                           GridPane.rowIndex="2" GridPane.columnIndex="1" />
                     </GridPane>
                  </TitledPane>
               </GridPane>

               <!-- Action Buttons -->
               <HBox alignment="CENTER" spacing="20" styleClass="button-bar">
                  <Button fx:id="saveButton" mnemonicParsing="false" onAction="#saveProfile"
                     text="Save Changes" styleClass="primary-button" />
                  <Button fx:id="cancelButton" mnemonicParsing="false" onAction="#closeWindow"
                     text="Cancel" styleClass="secondary-button" />
               </HBox>

               <Label fx:id="errorLabel" styleClass="error-message" visible="false" managed="false" />
            </VBox>
         </VBox>
      </ScrollPane>
   </center>

</BorderPane>